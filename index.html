<h1> Login Page </h1>

<p> Log into the login page </p>

{{if .}}
	<form id="protectedForm" action="/protected" method="POST">
		<input type="hidden" class="csrf_token" name="csrf_token" value="" />
	
		<button type="submit">Protected</button>
	</form>

	<form action="/logout" method="POST">
		<input type="hidden" class="csrf_token" name="csrf_token" value="" />
	  
		<button type="submit">Logout</button>
	</form>

{{else}}

	<form action="/register" method="POST">
		<input type="name" name="username">
		<input type="password" name="password">

		<input type="submit" value="Register">
	</form>


	<form action="/login" method="POST">
		<input type="name" name="username">
		<input type="password" name="password">

		<input type="submit" value="Login">
	</form>
{{end}}
  
  <script>
	function getCookie(name) {
		const value = `; ${document.cookie}`;
		const parts = value.split(`; ${name}=`);

		if (parts.length === 2)
		  return parts.pop().split(";").shift();
	}

	document.addEventListener("DOMContentLoaded", function () {
		const csrfToken = getCookie("csrf_token");

		if (csrfToken) {
			let csrfElements = document.getElementsByClassName("csrf_token")

			for (let i = 0; i < csrfElements.length; i++) {
				csrfElements[i].value = csrfToken
			}
	  	}
	});
  </script>
  